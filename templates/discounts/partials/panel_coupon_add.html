{% load i18n djicons %}

<!-- Header -->
<div class="side-sheet-header">
    <h3 class="sheet-title">{% trans "New Coupon" %}</h3>
    <button class="sheet-close" @click="closePanel()">
        {% icon "close-outline" %}
    </button>
</div>

<!-- Body -->
<div class="side-sheet-content">
    <form id="add-coupon-form"
          hx-post="{% url 'discounts:coupon_create' %}"
          hx-target="#datatable-body"
          hx-swap="innerHTML"
          @htmx:after-request="closePanel()"
          class="flex flex-col gap-4 p-6">
        {% csrf_token %}

        <!-- Code -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Code" %} *</label>
            <input type="text" name="code" class="input input-sm w-full"
                   placeholder="{% trans 'SUMMER2026' %}" style="text-transform: uppercase;" required>
        </div>

        <!-- Name -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Name" %} *</label>
            <input type="text" name="name" class="input input-sm w-full"
                   placeholder="{% trans 'Coupon name' %}" required>
        </div>

        <!-- Description -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Description" %}</label>
            <textarea name="description" class="textarea textarea-sm w-full" rows="2"
                      placeholder="{% trans 'Coupon description...' %}"></textarea>
        </div>

        <!-- Discount Type -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Discount Type" %} *</label>
            <select name="discount_type" class="select select-sm w-full" required>
                <option value="percentage">{% trans "Percentage" %}</option>
                <option value="fixed">{% trans "Fixed Amount" %}</option>
                <option value="buy_x_get_y">{% trans "Buy X Get Y" %}</option>
            </select>
        </div>

        <!-- Discount Value -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Discount Value" %} *</label>
            <input type="number" name="discount_value" class="input input-sm w-full"
                   min="0" step="0.01" placeholder="0" required>
        </div>

        <!-- Scope -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Scope" %}</label>
            <select name="scope" class="select select-sm w-full">
                <option value="order">{% trans "Entire Order" %}</option>
                <option value="products">{% trans "Specific Products" %}</option>
                <option value="categories">{% trans "Specific Categories" %}</option>
            </select>
        </div>

        <!-- Min Purchase -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Min. Purchase" %}</label>
            <input type="number" name="min_purchase" class="input input-sm w-full"
                   min="0" step="0.01" placeholder="0">
        </div>

        <!-- Max Discount -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Max Discount" %}</label>
            <input type="number" name="max_discount" class="input input-sm w-full"
                   min="0" step="0.01" placeholder="0">
            <span class="text-xs text-base-content/50 mt-1 block">{% trans "Leave empty for no limit" %}</span>
        </div>

        <!-- Usage Limit -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Usage Limit" %}</label>
            <input type="number" name="usage_limit" class="input input-sm w-full"
                   min="0" placeholder="0">
            <span class="text-xs text-base-content/50 mt-1 block">{% trans "0 = unlimited" %}</span>
        </div>

        <!-- Usage Per Customer -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Usage Per Customer" %}</label>
            <input type="number" name="usage_per_customer" class="input input-sm w-full"
                   min="1" value="1" placeholder="1">
        </div>

        <!-- Valid From -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Valid From" %}</label>
            <input type="datetime-local" name="valid_from" class="input input-sm w-full">
        </div>

        <!-- Valid Until -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Valid Until" %}</label>
            <input type="datetime-local" name="valid_until" class="input input-sm w-full">
        </div>

        <!-- Priority -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Priority" %}</label>
            <input type="number" name="priority" class="input input-sm w-full"
                   min="0" value="0" placeholder="0">
        </div>

        <!-- Stackable -->
        <div>
            <label class="checkbox checkbox-sm">
                <input type="checkbox" name="stackable">
                <span class="checkbox-mark"></span>
                <span class="ml-2 text-sm font-medium">{% trans "Stackable" %}</span>
            </label>
            <span class="text-xs text-base-content/50 mt-1 block">{% trans "Can be combined with other discounts" %}</span>
        </div>

        <!-- Active -->
        <div>
            <label class="checkbox checkbox-sm">
                <input type="checkbox" name="is_active" checked>
                <span class="checkbox-mark"></span>
                <span class="ml-2 text-sm font-medium">{% trans "Active" %}</span>
            </label>
        </div>
    </form>
</div>

<!-- Footer -->
<div class="side-sheet-footer">
    <div class="flex justify-end gap-2">
        <button type="button" class="btn btn-ghost btn-sm" @click="closePanel()">
            {% trans "Cancel" %}
        </button>
        <button type="submit" form="add-coupon-form" class="btn btn-sm color-primary">
            {% icon "add-outline" %}
            {% trans "Create Coupon" %}
        </button>
    </div>
</div>
